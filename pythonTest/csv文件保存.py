import csv
import os
quotes = [
            {
                "timeOpen": "2022-05-01T00:00:00.000Z",
                "timeClose": "2022-05-01T23:59:59.999Z",
                "timeHigh": "2022-05-01T16:25:00.000Z",
                "timeLow": "2022-05-01T01:38:00.000Z",
                "quote": {
                    "open": 37713.2650897410,
                    "high": 38627.8575048640,
                    "low": 37585.7873728754,
                    "close": 38469.0939025425,
                    "volume": 27002760109.7800000000,
                    "marketCap": 731986764311.8800000000,
                    "timestamp": "2022-05-01T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-02T00:00:00.000Z",
                "timeClose": "2022-05-02T23:59:59.999Z",
                "timeHigh": "2022-05-02T06:10:00.000Z",
                "timeLow": "2022-05-02T18:45:00.000Z",
                "quote": {
                    "open": 38472.1871454262,
                    "high": 39074.9717589518,
                    "low": 38156.5619033136,
                    "close": 38529.3278008977,
                    "volume": 32922642425.8300000000,
                    "marketCap": 733170725790.5100000000,
                    "timestamp": "2022-05-02T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-03T00:00:00.000Z",
                "timeClose": "2022-05-03T23:59:59.999Z",
                "timeHigh": "2022-05-03T08:13:00.000Z",
                "timeLow": "2022-05-03T20:23:00.000Z",
                "quote": {
                    "open": 38528.1100380674,
                    "high": 38629.9949742190,
                    "low": 37585.6203126624,
                    "close": 37750.4539152995,
                    "volume": 27326943244.2600000000,
                    "marketCap": 718385701942.7900000000,
                    "timestamp": "2022-05-03T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-04T00:00:00.000Z",
                "timeClose": "2022-05-04T23:59:59.999Z",
                "timeHigh": "2022-05-04T19:19:00.000Z",
                "timeLow": "2022-05-04T00:06:00.000Z",
                "quote": {
                    "open": 37748.0118484619,
                    "high": 39902.9502136511,
                    "low": 37732.0601966595,
                    "close": 39698.3706196742,
                    "volume": 36754404490.1100000000,
                    "marketCap": 755491473700.3100000000,
                    "timestamp": "2022-05-04T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-05T00:00:00.000Z",
                "timeClose": "2022-05-05T23:59:59.999Z",
                "timeHigh": "2022-05-05T05:20:00.000Z",
                "timeLow": "2022-05-05T19:25:00.000Z",
                "quote": {
                    "open": 39695.7463507190,
                    "high": 39789.2830202912,
                    "low": 35856.5161061082,
                    "close": 36575.1421327030,
                    "volume": 43106256317.3200000000,
                    "marketCap": 696088266356.3700000000,
                    "timestamp": "2022-05-05T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-06T00:00:00.000Z",
                "timeClose": "2022-05-06T23:59:59.999Z",
                "timeHigh": "2022-05-06T00:08:00.000Z",
                "timeLow": "2022-05-06T13:49:00.000Z",
                "quote": {
                    "open": 36573.1823550037,
                    "high": 36624.3595960026,
                    "low": 35482.1327440579,
                    "close": 36040.9223501524,
                    "volume": 37795577489.2700000000,
                    "marketCap": 685953792235.6400000000,
                    "timestamp": "2022-05-06T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-07T00:00:00.000Z",
                "timeClose": "2022-05-07T23:59:59.999Z",
                "timeHigh": "2022-05-07T11:23:00.000Z",
                "timeLow": "2022-05-07T22:55:00.000Z",
                "quote": {
                    "open": 36042.5036939934,
                    "high": 36129.9255204253,
                    "low": 34940.8246733344,
                    "close": 35501.9541442019,
                    "volume": 24375896405.9000000000,
                    "marketCap": 675729532873.6800000000,
                    "timestamp": "2022-05-07T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-08T00:00:00.000Z",
                "timeClose": "2022-05-08T23:59:59.999Z",
                "timeHigh": "2022-05-08T00:00:00.000Z",
                "timeLow": "2022-05-08T17:40:00.000Z",
                "quote": {
                    "open": 35502.9402038303,
                    "high": 35502.9402038303,
                    "low": 33878.9645692059,
                    "close": 34059.2642505879,
                    "volume": 36763041910.2400000000,
                    "marketCap": 648302121215.0100000000,
                    "timestamp": "2022-05-08T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-09T00:00:00.000Z",
                "timeClose": "2022-05-09T23:59:59.999Z",
                "timeHigh": "2022-05-09T01:22:00.000Z",
                "timeLow": "2022-05-09T23:59:00.000Z",
                "quote": {
                    "open": 34060.0154816197,
                    "high": 34222.0733234167,
                    "low": 30296.9534000531,
                    "close": 30296.9534000531,
                    "volume": 63355494961.4200000000,
                    "marketCap": 576716899022.8800000000,
                    "timestamp": "2022-05-09T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-10T00:00:00.000Z",
                "timeClose": "2022-05-10T23:59:59.999Z",
                "timeHigh": "2022-05-10T06:46:00.000Z",
                "timeLow": "2022-05-10T00:33:00.000Z",
                "quote": {
                    "open": 30273.6542188410,
                    "high": 32596.3078359205,
                    "low": 29944.8027374220,
                    "close": 31022.9054122253,
                    "volume": 59811038817.2700000000,
                    "marketCap": 590565398299.3600000000,
                    "timestamp": "2022-05-10T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-11T00:00:00.000Z",
                "timeClose": "2022-05-11T23:59:59.999Z",
                "timeHigh": "2022-05-11T10:16:00.000Z",
                "timeLow": "2022-05-11T21:29:00.000Z",
                "quote": {
                    "open": 31016.1827523335,
                    "high": 32013.4014927546,
                    "low": 28170.4130858639,
                    "close": 28936.3550311122,
                    "volume": 70388855817.9300000000,
                    "marketCap": 550870071633.8000000000,
                    "timestamp": "2022-05-11T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-12T00:00:00.000Z",
                "timeClose": "2022-05-12T23:59:59.999Z",
                "timeHigh": "2022-05-12T00:52:00.000Z",
                "timeLow": "2022-05-12T07:19:00.000Z",
                "quote": {
                    "open": 28936.7339259087,
                    "high": 30032.4389484654,
                    "low": 26350.4901742248,
                    "close": 29047.7510038538,
                    "volume": 66989173272.3600000000,
                    "marketCap": 553017241734.5900000000,
                    "timestamp": "2022-05-12T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-13T00:00:00.000Z",
                "timeClose": "2022-05-13T23:59:59.999Z",
                "timeHigh": "2022-05-13T14:43:00.000Z",
                "timeLow": "2022-05-13T00:21:00.000Z",
                "quote": {
                    "open": 29030.9103910716,
                    "high": 30924.8027176216,
                    "low": 28782.3296577337,
                    "close": 29283.1038115430,
                    "volume": 42841124537.4500000000,
                    "marketCap": 557525025253.1900000000,
                    "timestamp": "2022-05-13T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-14T00:00:00.000Z",
                "timeClose": "2022-05-14T23:59:59.999Z",
                "timeHigh": "2022-05-14T23:02:00.000Z",
                "timeLow": "2022-05-14T16:13:00.000Z",
                "quote": {
                    "open": 29285.6430028713,
                    "high": 30192.8031935087,
                    "low": 28702.9095341841,
                    "close": 30101.2664459848,
                    "volume": 28579868619.9800000000,
                    "marketCap": 573129618194.8800000000,
                    "timestamp": "2022-05-14T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-15T00:00:00.000Z",
                "timeClose": "2022-05-15T23:59:59.999Z",
                "timeHigh": "2022-05-15T23:58:00.000Z",
                "timeLow": "2022-05-15T05:10:00.000Z",
                "quote": {
                    "open": 30098.5866261369,
                    "high": 31308.1913582629,
                    "low": 29527.7403707191,
                    "close": 31305.1125686764,
                    "volume": 25835372064.6100000000,
                    "marketCap": 596074575228.3300000000,
                    "timestamp": "2022-05-15T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-16T00:00:00.000Z",
                "timeClose": "2022-05-16T23:59:59.999Z",
                "timeHigh": "2022-05-16T00:01:00.000Z",
                "timeLow": "2022-05-16T16:58:00.000Z",
                "quote": {
                    "open": 31304.3741442480,
                    "high": 31305.3425986839,
                    "low": 29251.8855581398,
                    "close": 29862.9182412919,
                    "volume": 32613897286.1700000000,
                    "marketCap": 568643328349.1000000000,
                    "timestamp": "2022-05-16T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-17T00:00:00.000Z",
                "timeClose": "2022-05-17T23:59:59.999Z",
                "timeHigh": "2022-05-17T13:46:00.000Z",
                "timeLow": "2022-05-17T18:36:00.000Z",
                "quote": {
                    "open": 29862.4081929416,
                    "high": 30694.4909508770,
                    "low": 29570.3019001848,
                    "close": 30425.8572767960,
                    "volume": 29101473475.4300000000,
                    "marketCap": 579391415566.4200000000,
                    "timestamp": "2022-05-17T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-18T00:00:00.000Z",
                "timeClose": "2022-05-18T23:59:59.999Z",
                "timeHigh": "2022-05-18T00:37:00.000Z",
                "timeLow": "2022-05-18T23:59:00.000Z",
                "quote": {
                    "open": 30424.4792225503,
                    "high": 30618.7159811610,
                    "low": 28720.2713997454,
                    "close": 28720.2713997454,
                    "volume": 31285268318.5300000000,
                    "marketCap": 546936441379.5100000000,
                    "timestamp": "2022-05-18T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-19T00:00:00.000Z",
                "timeClose": "2022-05-19T23:59:59.999Z",
                "timeHigh": "2022-05-19T15:50:00.000Z",
                "timeLow": "2022-05-19T02:14:00.000Z",
                "quote": {
                    "open": 28720.3585631289,
                    "high": 30430.7522309591,
                    "low": 28708.9550418266,
                    "close": 30314.3349534984,
                    "volume": 33773447706.6700000000,
                    "marketCap": 577316228899.3000000000,
                    "timestamp": "2022-05-19T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-20T00:00:00.000Z",
                "timeClose": "2022-05-20T23:59:59.999Z",
                "timeHigh": "2022-05-20T01:43:00.000Z",
                "timeLow": "2022-05-20T17:31:00.000Z",
                "quote": {
                    "open": 30311.1193461763,
                    "high": 30664.9763670009,
                    "low": 28793.6060336771,
                    "close": 29200.7400877833,
                    "volume": 30749382604.8000000000,
                    "marketCap": 556131920268.7900000000,
                    "timestamp": "2022-05-20T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-21T00:00:00.000Z",
                "timeClose": "2022-05-21T23:59:59.999Z",
                "timeHigh": "2022-05-21T16:14:00.000Z",
                "timeLow": "2022-05-21T01:31:00.000Z",
                "quote": {
                    "open": 29199.8590065676,
                    "high": 29588.8688149389,
                    "low": 29027.3938182935,
                    "close": 29432.2259634811,
                    "volume": 17274840441.5000000000,
                    "marketCap": 560565793081.5300000000,
                    "timestamp": "2022-05-21T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-22T00:00:00.000Z",
                "timeClose": "2022-05-22T23:59:59.999Z",
                "timeHigh": "2022-05-22T23:28:00.000Z",
                "timeLow": "2022-05-22T05:01:00.000Z",
                "quote": {
                    "open": 29432.4723986064,
                    "high": 30425.8605130009,
                    "low": 29275.1827640655,
                    "close": 30323.7218952694,
                    "volume": 21631532269.6700000000,
                    "marketCap": 577568895835.7200000000,
                    "timestamp": "2022-05-22T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-23T00:00:00.000Z",
                "timeClose": "2022-05-23T23:59:59.999Z",
                "timeHigh": "2022-05-23T07:35:00.000Z",
                "timeLow": "2022-05-23T23:20:00.000Z",
                "quote": {
                    "open": 30309.3964800086,
                    "high": 30590.5864837253,
                    "low": 28975.5596093713,
                    "close": 29098.9097457340,
                    "volume": 31483454556.8200000000,
                    "marketCap": 554268758109.3100000000,
                    "timestamp": "2022-05-23T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-24T00:00:00.000Z",
                "timeClose": "2022-05-24T23:59:59.999Z",
                "timeHigh": "2022-05-24T23:20:00.000Z",
                "timeLow": "2022-05-24T14:13:00.000Z",
                "quote": {
                    "open": 29101.1252943246,
                    "high": 29774.3547202654,
                    "low": 28786.5894517928,
                    "close": 29655.5861328400,
                    "volume": 26616506244.9000000000,
                    "marketCap": 564895173841.0600000000,
                    "timestamp": "2022-05-24T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-25T00:00:00.000Z",
                "timeClose": "2022-05-25T23:59:59.999Z",
                "timeHigh": "2022-05-25T04:01:00.000Z",
                "timeLow": "2022-05-25T12:02:00.000Z",
                "quote": {
                    "open": 29653.1352936197,
                    "high": 30157.7845345246,
                    "low": 29384.9493491208,
                    "close": 29562.3612655464,
                    "volume": 27525063551.2500000000,
                    "marketCap": 563145244691.9100000000,
                    "timestamp": "2022-05-25T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-26T00:00:00.000Z",
                "timeClose": "2022-05-26T23:59:59.999Z",
                "timeHigh": "2022-05-26T04:23:00.000Z",
                "timeLow": "2022-05-26T13:31:00.000Z",
                "quote": {
                    "open": 29564.7765107969,
                    "high": 29834.1592888614,
                    "low": 28261.9057088448,
                    "close": 29267.2246712304,
                    "volume": 36774325352.4300000000,
                    "marketCap": 557547946793.1100000000,
                    "timestamp": "2022-05-26T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-27T00:00:00.000Z",
                "timeClose": "2022-05-27T23:59:59.999Z",
                "timeHigh": "2022-05-27T00:32:00.000Z",
                "timeLow": "2022-05-27T18:30:00.000Z",
                "quote": {
                    "open": 29251.1408637204,
                    "high": 29346.9430247971,
                    "low": 28326.6136487276,
                    "close": 28627.5748531586,
                    "volume": 36582005748.1600000000,
                    "marketCap": 545388222663.7600000000,
                    "timestamp": "2022-05-27T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-28T00:00:00.000Z",
                "timeClose": "2022-05-28T23:59:59.999Z",
                "timeHigh": "2022-05-28T13:19:00.000Z",
                "timeLow": "2022-05-28T01:46:00.000Z",
                "quote": {
                    "open": 28842.1038446105,
                    "high": 29135.9182578598,
                    "low": 28554.5660193876,
                    "close": 29023.4880392653,
                    "volume": 19252320707.9800000000,
                    "marketCap": 552958193308.4800000000,
                    "timestamp": "2022-05-28T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-29T00:00:00.000Z",
                "timeClose": "2022-05-29T23:59:59.999Z",
                "timeHigh": "2022-05-29T22:43:00.000Z",
                "timeLow": "2022-05-29T02:28:00.000Z",
                "quote": {
                    "open": 29019.8674141315,
                    "high": 29498.0088389573,
                    "low": 28841.1064887385,
                    "close": 29445.9576239208,
                    "volume": 18093886409.1600000000,
                    "marketCap": 561034743433.2500000000,
                    "timestamp": "2022-05-29T23:59:59.999Z"
                }
            },
            {
                "timeOpen": "2022-05-30T00:00:00.000Z",
                "timeClose": "2022-05-30T23:59:59.999Z",
                "timeHigh": "2022-05-30T21:25:00.000Z",
                "timeLow": "2022-05-30T00:58:00.000Z",
                "quote": {
                    "open": 29443.3657109831,
                    "high": 31949.6316183118,
                    "low": 29303.5716330740,
                    "close": 31726.3906858653,
                    "volume": 39277993273.9400000000,
                    "marketCap": 604513442525.6400000000,
                    "timestamp": "2022-05-30T23:59:59.999Z"
                }
            }
        ]
def format(quotes):
    new_quotes = []
    for quote in quotes:
        temp_dict = {
            "timeOpen": quote['timeOpen'],
            "timeClose": quote['timeClose'],
            "timeHigh": quote['timeHigh'],
            "timeLow": quote['timeLow'],

            "open": quote['quote']['open'],
            "high": quote['quote']['high'],
            "low": quote['quote']['low'],
            "close": quote['quote']['close'],
            "volume": quote['quote']['volume'],
            "marketCap": quote['quote']['marketCap'],
            "timestamp": quote['quote']['timestamp']
        }
        new_quotes.append(temp_dict)

    return new_quotes

fieldnames = ['timeClose', 'timeOpen', 'quote', 'timeHigh','timeLow','open','high','low','close','volume','marketCap','timestamp']
with open('数据.csv', mode='a', newline='', encoding='utf-8-sig') as f:
    writer = csv.DictWriter(f, fieldnames=fieldnames)
    # 判断表格内容是否为空，如果为空就添加表头
    if not os.path.getsize('数据.csv'):
    	writer.writeheader()  # 写入表头
    writer.writerows(format(quotes))


